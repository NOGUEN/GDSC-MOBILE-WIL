# 개요

`동기`와 `비동기`, 프로그래밍을 공부하다보면 항상 등장하는 개념이다.

중요한 개념이고 꼭 알아야한다고 하지만 이게 왜 중요한 개념인지 잘 이해하지 못하고 넘어간 적이 많다.▼

![image](https://user-images.githubusercontent.com/65299607/202997703-bd4e6cf3-a9c8-4909-9265-6eb029975e71.jpeg)


외국인이 하는 개그에 따라 웃는 느낌

하지만 `동기`, `비동기`라는 것은 사실 엄청나게 거창한 것은 아니고 우리의 상식 선에서 충분히 생각해 볼 수 있는 개념이다.

컴퓨터 공학과 학생이라면 아마 CS수업 중에서 이미 이와 비슷한 이야기를 듣기도 했을 것이다.

컴퓨터 전반에서 사용되고 있는 개념이면서 이해하고 보면 아주 당연한 이야기이기에 쉽게 이해할 수 있을 것이다.

# 동기(Synchronous)

## 동기란?

`동기`는 영어로 `Synchronous`이고, 다르게 번역하면 **동시에**라는 의미이다.

그렇다면 무엇을 동시에 수행하는 것이길래 `동기`라고 부르는 것일까?

그 답은 **요청**과 **결과**가 **동시에** 이루어지는 것이다.

즉, `동기`는 클라이언트가 요청을 했을 때 결과도 같이 나와야한다는 것이다.

어떤 말인지 헷갈릴 수 있는데 간단한 예시를 들어보면 아래와 같다.

내가 애플스토어에 직접 찾아가서 맥북을 보여달라고 요구했다면, 애플스토어 매니저는 내 요구를 그 자리에서 즉각적으로 들어줘야한다는 것이다.

맥북을 보여주세요! 라고 했다면 그 자리에서 맥북을 꺼내서 보여줘야한다는 것이다.

시간이 얼마나 걸려도 상관이 없다.

내 요청이 들어갔고, 내 요청에 시간이 얼마나 걸리든 딴 짓하지 않고 **요청을 바로 들어주는 것**이다.▼

![image-2](https://user-images.githubusercontent.com/65299607/202997771-0205efd7-4173-4471-8078-327276ff2439.jpeg)

맥북을 만들어오나? 아뇨 캘리포니아에 직접 가서 받아왔습니다.

## 동기의 수행 그래프

`동기`의 수행을 그래프로 보면 아래와 같은데, 이 그래프 때문에 혼동하는 사람도 종종 생긴다.

그래프를 보면 요청과 요청의 결과가 순차적으로 일어나기 때문에 이건 `비동기`가 아닌가? 하기도 하는데 요청과 결과의 큰 쌍으로 봤을 때의 `동기`는 이 그래프가 맞다.▼

![image-3](https://user-images.githubusercontent.com/65299607/202997825-c12b6c2d-a96f-4a55-aeb5-5d475e32de0c.jpeg)


## 즉, 동기란

> *`동기`는 앞의 일(요청에 대한 수행)이 끝나기를 기다리고 그 뒤의 일을 수행하는 것, 즉 직렬적으로 수행하는 것을 말한다.*
> 

# 비동기(Asynchronous)

## 비동기란?

`비동기`는 `동기`와 반대의 의미로 **비동시** 라는 의미다.

즉, **요청**과 **결과**가 **동시에 일어나지 않는다**는 말이다.

무엇을 동시에 수행하지 않냐고 하면, 앞에서 말한 요청과 그 요청에 대한 수행이 동시에 일어나지 않는다는 것이다.

아까의 예시를 그대로 사용해보겠다.

내가 애플스토어에 직접 찾아가서 맥북을 보여달라고 요구했다면, 애플스토어 매니저는 내 요구를 일단 받아놓고 수행을 해준다.

하지만 애플 스토어 매니저가 맥북을 바로 찾아줄 거 같지 않아보이고, 실제로 바로 찾아줄 생각도 없어보인다.

그래서 나는 애플 스토어 매니저가 보여줄 맥북을 하염없이 기다리는게 아니라 그 동안 다른 일을 하는 것이다.▼

![image-4](https://user-images.githubusercontent.com/65299607/202997858-74b7a548-25ec-48c9-a967-fbeef2f697d7.jpeg)


마치 **PipeLining**을 하듯 일을 수행하게 된다는 것이다.▼

![image-5](https://user-images.githubusercontent.com/65299607/202997881-2a79bf2a-3f7f-4938-929c-34b69d3f259e.jpeg)


## 즉, 비동기란

> `*비동기`는 앞의 일(요청에 대한 수행)이 끝나기를 기다리지 않고, 그 뒤의 일을 수행하는 것, 즉 병렬적으로 수행하는 것을 말한다.*
> 

# 비동기의 문제점과 헷갈릴만한 요소

## 문제점

설명만 들어봤을 때는 충분한 자원이 있다면 동기보다 비동기가 훨씬 우월한 구동방식이다.

둘을 비교했을 때 `동기`는 마치 ‘컵라면 7개라서 21분을 기다린거야?’ 같이 바보같이 보여지기 쉽상이다.▼

![image-6](https://user-images.githubusercontent.com/65299607/202997917-55ddc810-82fd-48a3-b0f4-ccece953d18b.jpeg)


맞아, 이 바보야 7 x 3은 21이잖아!!!!

하지만 비동기라고 문제가 없는것은 아니다.

비동기에서는 동기와 다르게 좀 더 복잡한 문제가 발생한다.

지금까지 프로그램을 만들때는 전부 동기로 작업이 되어 순서가 명확했지만, 비동기로 프로그래밍을 하게 되면 그 순서가 약간 모호해진다.

사채업을 하는 사람과 채무자, 두 명의 사람이 있다고 해보자.

채무자는 이미 다른데서 돈을 빌려서, 빚을 갚기 위해 돌려막기를 해야하는 상황이다.

그래서 다른 사채업자에게 돈을 빌려달라고 요청했다.

다른 사채업자는 알겠다고 했지만, 다른 사람 돈을 수금하러 가느라 이 채무자에게 당일에 돈을 주지 못했다.

그러나 문제는 채무자가 돈을 갚기로 한 날은 다음날, 채무자는 돈을 갚지 못해 끌려갔다…

위의 채무자와 사채업자를 클라이언트와 서버로 생각하게 되면 그게 바로 HTTP요청에서의 비동기 문제가 된다.

동기 방식으로 HTTP 요청을 보내면 요청에 대한 결과를 바로 받고 결과를 보여줄 수 있다.

이 경우에는 정상적인 동작이지만, 비동기방식으로 HTTP 요청을 보내면 요청에 대한 결과를 바로 받는다는 보장이 없어지고, 실제로도 결과를 바로 못받는 경우가 생기면서 데이터를 제대로 보여주지 못하는 문제가 발생하게 된다.

## 해결법

그렇다면 이런 문제를 어떻게 해결할까?

이런저런 방법이 있겠지만 가장 쉬운 방식은 (필자는 아직 이거밖에 모른다) 비동기로 돌아가는 코드를 동기로 돌아가게 바꾸는 것이다.

Flutter(Dart)에서는 비동기로 동작하는 함수가 있는 큰 함수에 async를 붙이고, 비동기로 동작하는 함수 앞에 await을 붙여주면 된다.

Future<>

시간이 걸리는 함수들이 값을 반환할 때 앞에 붙임.

이 함수들은 값을 바로 반환하지 않고 나중에 값을 주기 때문에 명시해줘야함.

이 함수를 사용할 때는 await을 붙이면 Future을 없애고 값을 받아올 수 있음.
